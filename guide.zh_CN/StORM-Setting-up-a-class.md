# ä½¿ç”¨ StORM æ•°æ®ç±»

é¦–å…ˆè¯·å°†å‡½æ•°åº“å¼•å…¥ç¨‹åºï¼š

``` swift
import PostgresStORM
// å¦‚æžœæ‚¨ç”¨çš„å…¶ä»–æ•°æ®æºï¼Œæ¯”å¦‚SQLiteï¼Œè¯·è¿™æ ·å£°æ˜Žï¼š
import SQLiteStORM
```

å½“æ‚¨åœ¨ StORM åŸºç¡€ä¸Šåˆ›å»ºæ•°æ®ç±»çš„æ—¶å€™ï¼Œä¼šè§¦å‘æ•°æ®åº“è‡ªåŠ¨æž„é€ ä¸€ä¸ªè¡¨æ ¼ï¼Œä½¿å¾—ä¸Žæ•°æ®åº“æ“ä½œå®žçŽ°è‡ªåŠ¨åŒ–ã€‚

å¦‚æžœæ‚¨ä½¿ç”¨çš„æ˜¯ PostgreSQLï¼Œè¯·ä»¥ PostgresStORM ä½œä¸ºåŸºç±»å£°æ˜Žï¼š

``` swift
class User: PostgresStORM {
}
```

å¦‚æžœæ‚¨ä½¿ç”¨çš„æ˜¯ SQLiteï¼Œè¯·ä»¥ SQLiteStORM ä½œä¸ºåŸºç±»å£°æ˜Žï¼š

``` swift
class User: SQLiteStORM {
}
```

ä¸‹ä¸€æ­¥ï¼Œè¯·ä¸ºæ‚¨çš„ç±»å¢žåŠ å±žæ€§ï¼Œè¯¥æ“ä½œå°†è‡ªåŠ¨æ›´ç»†ç›¸å…³çš„æ•°æ®è¡¨ç»“æž„ã€‚åœ¨æ­¤å¼ºçƒˆå»ºè®®åœ¨ç¼–å†™å±žæ€§éƒ¨åˆ†ç¨‹åºçš„æ—¶å€™ï¼Œè¯·ä¸è¦ä½¿ç”¨éžæ ‡å‡†å­—ç¬¦ï¼Œå› ä¸ºå¯èƒ½æ•°æ®åº“ä¸æŽ¥å—è¿™æ ·çš„å­—æ®µï¼Œæ¯”å¦‚â€œðŸ’â€ã€‚

*âš ï¸æ³¨æ„âš ï¸* è¯¥å¯¹è±¡çš„ç¬¬ä¸€ä¸ªå±žæ€§å°†æˆä¸ºå¯¹åº”æ•°æ®è¡¨çš„ä¸»ç´¢å¼• â€”â€” ä¼ ç»Ÿçš„æ–¹å¼å°±æ˜¯ç»™ä¸»ç´¢å¼•åˆ—èµ·åå«åš `id`ï¼Œè™½ç„¶æ‚¨å¯ä»¥ä¸ºä¸»ç´¢å¼•å­—æ®µè®¾ç½®ä»»ä½•æœ‰æ•ˆçš„åå­—ã€‚SQLè¿™ç§å…³ç³»æ•°æ®åº“çš„ä¸»ç´¢å¼•å…¸åž‹ç±»åž‹æ˜¯æ•´åž‹ã€å­—ç¬¦ä¸²æˆ–è€…UUIDç¼–ç ã€‚å¦‚æžœæ‚¨çš„ä¸»ç´¢å¼•ä¸æ˜¯è‡ªåŠ¨é€’å¢žçš„æ•´æ•°ï¼Œåˆ™ä¸€å®šè¦è®¾ç½®å¥½è¿™ä¸ªidå€¼ï¼Œä»¥ä¿è¯æ•°æ®çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§ã€‚

``` swift
// âš ï¸æ³¨æ„âš ï¸ï¼šç¬¬ä¸€ä¸ªå±žæ€§å°†æˆä¸ºä¸»ç´¢å¼•å­—æ®µï¼Œæ‰€ä»¥åº”è¯¥æ˜¯IDã€‚
var id				: Int = 0
var firstname		: String = ""
var lastname		: String = ""
var email			: String = ""
```

æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ä¸Šé¢çš„ç¨‹åºé€šè¿‡ç»™æ¯ä¸ªå­—æ®µè®¾ç½®é»˜è®¤å€¼ï¼Œè€Œä¸æ˜¯åœ¨`init()`æž„é€ å‡½æ•°ä¸­è®¾ç½®ã€‚è¿™æ ·çœ‹èµ·æ¥æ›´ç®€å•ä¸€äº›ã€‚å¦‚æžœæ‚¨é€‰æ‹©è‡ªè¡Œç¼–å†™`init()` æˆ– `init(_ connect: XXConnect)` æž„é€ å‡½æ•°ï¼Œè¯·æ³¨æ„ä¸€å®šè¦åœ¨æž„é€ å‡½æ•°ä¸­é¦–å…ˆè°ƒç”¨åŸºç±»çš„æž„é€ å‡½æ•°`super.init()`ï¼Œè€Œä¸”è¦å°å¿ƒæ•°æ®åº“çš„è¿žæŽ¥å±žæ€§ã€‚

### ç¡®å®šæ•°æ®è¡¨æ ¼

ä¸ºäº†é¿å…æ•°æ®åº“å†…çš„å‘½åå†²çªï¼Œè¯·ç”¨ä¸‹åˆ—æ–¹æ³•è‡ªè¡Œè®¾ç½®æ¯ä¸ªæ•°æ®ç±»çš„å¯¹åº”æ•°æ®è¡¨åç§°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

``` swift
override open func table() -> String {
	return "users"
}
```

### æ•°æ®ç±»å¯¹è±¡ä¸Žæ•°æ®åº“çš„å±žæ€§ç»‘å®š

ä¸ºäº†èƒ½å¤Ÿè®©æ–°ç¼–å†™çš„æ•°æ®ç±»æ­£å¸¸å·¥ä½œï¼Œæ¯”å¦‚æŸ¥è¯¢æ•°æ®å¹¶æŠŠç»“æžœè®°å½•é›†è½¬æ¢æˆä¸ºå¯¹è±¡æ•°ç»„ç­‰ç­‰ï¼Œè¯·ä¸€å®šè¦åœ¨æ‚¨çš„æ•°æ®ç±»ä¸­å¢žåŠ ä»¥ä¸‹ä¸¤ä¸ªå‡½æ•°ï¼š

``` swift
override func to(_ this: StORMRow) {
	id				= this.data["id"] as! Int
	firstname		= this.data["firstname"] as! String
	lastname		= this.data["lastname"] as! String
	email			= this.data["email"] as! String
}

func rows() -> [User] {
	var rows = [User]()
	for i in 0..<self.results.rows.count {
		let row = User()
		row.to(self.results.rows[i])
		rows.append(row)
	}
	return rows
}
```

ç‰¹åˆ«æ³¨æ„åœ¨ `to` ï¼ˆç»‘å®šåˆ°ï¼‰å‡½æ•°ä¸­ï¼Œè¦é€ä¸ªæŒ‡å®šæ‰€æœ‰å±žæ€§ã€‚
è¿™ç§å¤„ç†æ–¹æ³•çš„å¥½å¤„æ˜¯èƒ½å¤Ÿåœ¨è¿™ä¸ªé˜¶æ®µéªŒè¯ç»‘å®šæ“ä½œæ˜¯å¦æœ‰æ•ˆï¼Œæ‚¨è¿˜å¯ä»¥åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å¢žåŠ æ›´å¤šè‡ªå®šä¹‰æ“ä½œã€‚

è€Œ`rows` ï¼ˆæ•°æ®è¡Œï¼‰å‡½æ•°åˆ™æ˜¯ç”¨äºŽå¤„ç†ç®€åŒ–ç»“æžœè®°å½•é›†ä¸ºå¯¹è±¡æ•°ç»„ã€‚è¯·æ³¨æ„åœ¨ä½¿ç”¨ä¸Šé¢çš„ä»£ç æ—¶ï¼Œâš ï¸ä¸€å®šè¦âš ï¸æŠŠç¬¬ä¸‰è¡Œçš„å¯¹è±¡ç±»åç§°æ”¹è¿‡æ¥ã€‚


### å®Œæ•´æ¡ˆä¾‹

ä»¥ä¸‹æ˜¯æ•´ä¸ªç±»çš„å®Œæ•´ä¾‹å­ï¼š

``` swift
import PostgresStORM

class User: PostgresStORM {
	// NOTE: æ³¨æ„ï¼Œç¬¬ä¸€ä¸ªå±žæ€§å°†ä¼šæ˜¯æ•°æ®è¡¨ä¸»ç´¢å¼•ã€‚
	var id				: Int = 0
	var firstname		: String = ""
	var lastname		: String = ""
	var email			: String = ""


	override open func table() -> String {
		return "users"
	}

	override func to(_ this: StORMRow) {
		id				= this.data["id"] as! Int
		firstname		= this.data["firstname"] as! String
		lastname		= this.data["lastname"] as! String
		email			= this.data["email"] as! String
	}

	func rows() -> [User] {
		var rows = [User]()
		for i in 0..<self.results.rows.count {
			let row = User()
			row.to(self.results.rows[i])
			rows.append(row)
		}
		return rows
	}
}
```
